{%- assign site_pages = site.html_pages
    | sort: "path"
    | sort: "sort"
    | where_exp: "item", "item.url != '/404.html'"
    | where_exp: "item", "item.url != '/search.html'" -%}

{%- assign site_dirs  = site_pages | where_exp: "item", "item.url contains 'README.html' or item.dir == item.url" -%}
{% assign site_files = "" | split: "" %}
{% for p in site_pages %}
    {% if p.dir != p.url %}
        {% unless p.url contains "README.html" %}
            {% assign site_files = site_files | push:p %}
        {% endunless %}
    {% endif %}
{% endfor %}

{% assign site_dirs_dirs = "" | split: "" %}
{% for d in site_dirs %}
    {% assign site_dirs_dirs = site_dirs_dirs | push:d.dir %}
{% endfor %}
{% assign site_dirs_dirs_json = site_dirs_dirs | jsonify %}

{% assign site_dirs_titles = "" | split: "" %}
{% for d in site_dirs %}
    {% assign site_dirs_titles = site_dirs_titles | push:d.title %}
{% endfor %}
{% assign site_dirs_titles_json = site_dirs_titles | jsonify %}

{% assign site_files_urls = "" | split: "" %}
{% for p in site_pages %}
    {% if p.dir != p.url %}
        {% unless p.url contains "README.html" %}
            {% assign site_files_urls = site_files_urls | push:p.url %}
        {% endunless %}
    {% endif %}
{% endfor %}
{% assign site_files_urls_json = site_files_urls | jsonify %}

{% assign site_files_titles = "" | split: "" %}
{% for p in site_pages %}
    {% if p.dir != p.url %}
        {% unless p.url contains "README.html" %}
            {% assign site_files_titles = site_files_titles | push:p.title %}
        {% endunless %}
    {% endif %}
{% endfor %}
{% assign site_files_titles_json = site_files_titles | jsonify %}

{% assign site_files_sort = "" | split: "" %}
{% for p in site_pages %}
    {% if p.dir != p.url %}
        {% unless p.url contains "README.html" %}
            {% assign site_files_sort = site_files_sort | push:p.sort %}
        {% endunless %}
    {% endif %}
{% endfor %}
{% assign site_files_sort_json = site_files_sort | jsonify %}